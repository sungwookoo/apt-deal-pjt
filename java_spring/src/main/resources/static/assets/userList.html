<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link href="./css/common.css" rel="stylesheet" />
    <title>구해줘 홈즈</title>
  </head>
  <body>
    <!-- Header -->
    <div class="include" data-html="header.html"></div>

    <!-- Main -->
    <main class="container mt-4">
      <div style="height: 150px"></div>
      <div class="bg-light bg-opacity-75 pt-4" style="min-height: 700px">
        <div style="height: 30px"></div>
        <div class="row">
          <div class="col-9 ms-4 ps-4 fs-3">
            <i class="fa-solid"></i>&nbsp;&nbsp;회원정보
            <form id="form-search" method="POST" action="">
              <input
                type="text"
                class="form-control"
                id="searchKeyword"
                name="word"
                placeholder="ID검색..."
                style="width: 300px; height: 30px; font-size: 15px"
              />
              <button id="btn-search" class="btn btn-dark" type="button">검색</button>
            </form>
          </div>
        </div>
        <div
          class="row ms-5 mt-4 text-dark text-center fw-bold fs-5 border-dark border-3 border-bottom"
          style="width: 92%"
        >
          <div class="col-2">아이디</div>
          <div class="col-2 border-dark border-1">이름</div>
          <div class="col-2 border-dark border-1">전화번호</div>
          <div class="col-3 border-dark border-1">이메일</div>
          <div class="col-3 border-dark border-1">가입날짜</div>
        </div>
        <div id="userList"></div>

        <div class="d-flex justify-content-center mt-5">
          <button class="btn btn-dark me-3">left</button>
          <a class="text-black mx-2 align-self-center text-decoration-none" href="#">1</a>
          <a class="text-black mx-2 align-self-center text-decoration-none" href="#">2</a>
          <a class="text-primary mx-2 align-self-center" href="#">3</a>
          <a class="text-black mx-2 align-self-center text-decoration-none" href="#">4</a>
          <a class="text-black mx-2 align-self-center text-decoration-none" href="#">5</a>
          <button class="btn btn-dark ms-3">right</button>
        </div>

        <div style="height: 50px"></div>
      </div>
    </main>

    <div style="height: 70px"></div>

    <!-- Footer -->
    <div class="include" data-html="footer.html"></div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <script src="./js/include.js"></script>
    <script src="./js/header.js"></script>
    <script>
      document.querySelector('#btn-search').addEventListener('click', function () {
        let keyword = document.querySelector('#searchKeyword').value;

        fetch(`${root}/api/user/search/${keyword}`)
          .then(response => response.json())
          .then(data => makeList(data));
      });

      window.onload = function () {
        fetch(`${root}/api/user/search/no--keyword`)
          .then(response => response.json())
          .then(data => makeList(data));
      };

      function makeList(data) {
        console.log(data);
        let el = document.querySelector('#userList');
        let options = '';

        Object.keys(data).forEach(function (key) {
          options += `<div class="row ms-5 pt-4 text-dark text-center fs-6" style="width: 92%"> `;
          options += `<div
              class="col-2"
              onclick="toAdminUserInfo('${data[key]['userId']}')"
              style="cursor: pointer"
            >`;
          options += `${data[key]['userId']}`;
          options += `</div>
            <div class="col-2">${data[key]['userName']}</div>
            <div class="col-2">${data[key]['userPhone']}</div>
            <div class="col-3">${data[key]['emailId']}@${data[key]['emailDomain']}</div>
            <div class="col-3">${data[key]['joinDate']}</div>
          </div>`;
        });

        el.innerHTML = options;
      }

      function toAdminUserInfo(id) {
        sessionStorage.setItem('detailId', id);

        location.href = '/assets/adminUserInfo.html';
      }
    </script>
  </body>
</html>
