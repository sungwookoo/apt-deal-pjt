<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Custom css -->
  <link href="./css/common.css" rel="stylesheet" />
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
  <!-- font awesome -->
  <script src="https://kit.fontawesome.com/c452641c94.js" crossorigin="anonymous"></script>
  <title>공지사항</title>
</head>

<body>
  <!-- Header -->
  <div class="include" data-html="header.html"></div>
  <!-- Main Contents -->
  <main class="container mt-4">
    <div style="height: 150px"></div>
    <div class="bg-light bg-opacity-75 pt-4">
      <div style="height: 30px"></div>
      <div class="ps-2 fs-3 text-center" id>
        <i class="fas fa-clipboard-list"></i>
      </div>
      <div style="margin-left: 50px">
        <isnput type="hidden" value="" id="noticeNo">
        <span>작성자 : <span id="userName"></span></span>
        <span>조회수 : <span id="hit"></span></span>
      </div>
      <div class="row ms-5 mt-4 text-dark text-center fw-bold border-dark border-3 border-bottom" style="width: 92%">
      </div>

      <div class="row ms-5 text-center border-dark mt-2 fs-3 mb-1">
        <div class="col-11 border-dark border-1 fw-bold">내용</div>
      </div>
      <div class="ps-2 fs-6 text-center m-4">
        <div id="content"></div>
      </div>

      <div class="d-flex justify-content-center col mt-5">
        <button class="btn btn-dark" onclick="goModify()">
          수정
        </button>
        <button class="btn btn-dark ms-2" onclick="deleteNotice()">
          삭제
        </button>
        <button class="btn btn-dark ms-2" onclick="location.href='/assets/notice.html'">
          목록
        </button>
      </div>

      <div style="height: 50px"></div>
    </div>
  </main>

  <div style="height: 400px"></div>

  <!-- Footer -->
  <div class="include" data-html="footer.html"></div>
  <!-- Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <!-- Custom JS -->
  <script src="./js/include.js"></script>
  <script src="./js/header.js"></script>
  <script src="./js/notice.js"></script>
  <script>
    window.onload = function () {
      let noticeNo = sessionStorage.getItem('noticeNo');
      document.getElementById('noticeNo').setAttribute('value', noticeNo);
      fetch(`${root}/api/notice/` + noticeNo)
        .then(response => response.json())
        .then(data => setNotice(data));
    };

    function setNotice(data) {
      let userName = document.getElementById('userName');
      let hit = document.getElementById('hit');
      let content = document.getElementById('content');

      userName.innerText = data.userName;
      hit.innerText = data.hit;
      content.innerText = data.content;
    }

    function goModify() {
      let no = document.getElementById('noticeNo').value;
      sessionStorage.setItem('noticeNo', no);
      location.href = '/assets/noticeModify.html';
    }

    function deleteNotice() {
      let no = document.getElementById('noticeNo').value;

      let config = {
        method: "DELETE",
        headers: {
          "Content-Type": "application/json"
        }
      };
      fetch(`${root}/api/notice/` + no, config)
        .then(response => response.json())
        .then(data => {
          if (confirm("삭제한 글은 복구되지 않습니다. 삭제하시겠습니까?\n")) {
            alert("삭제되었습니다.");
            location.href = '/assets/notice.html';
          }
        });
    }
  </script>
</body>

</html>