<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- Custom css -->
<link href="./css/common.css" rel="stylesheet" />
<!-- Bootstrap -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
	crossorigin="anonymous" />
<!-- font awesome -->
<script src="https://kit.fontawesome.com/c452641c94.js"
	crossorigin="anonymous"></script>
<title>공지사항</title>
</head>
<body>
	<!-- Header -->
	<div class="include" data-html="header.html"></div>
	<div style="height: 100px"></div>
	<div class="row justify-content-center">
		<div class="col-sm-8 justify-content-center"
			style="background-color: rgba(188, 188, 188, 0.5);">
			<div class="row justify-content-center">
				<div class="col-lg-8 col-md-10 col-sm-12">
					<h2 class="my-3 py-3 shadow-sm bg-light text-center">
						<mark class="sky">글수정</mark>
					</h2>
				</div>
				<div class="col-lg-8 col-md-10 col-sm-12">
					<form id="form-register" action="">
						<input type="hidden" id="noticeNo" value="">
						<div class="mb-3">
							<label for="subject" class="form-label">제목 : </label> <input
								type="text" class="form-control" id="subject" name="subject"
								placeholder="제목..." value="" />
						</div>
						<div class="mb-3">
							<label for="content" class="form-label">내용 : </label>
							<textarea class="form-control" id="content" name="content"
								rows="15"></textarea>
						</div>
						<div class="col-auto text-center">
							<button type="button" id="btn-register"
								class="btn btn-primary mb-3">수정</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div style="height: 80px"></div>
	<!-- Footer -->
	<div class="include" data-html="footer.html"></div>
	<!-- Bootstrap -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
		crossorigin="anonymous"></script>
	<!-- Custom JS -->
	<script src="./js/include.js"></script>
	<script src="./js/header.js"></script>
	<script>
		  window.onload = function () {
		        let noticeNo = sessionStorage.getItem('noticeNo');
		        document.getElementById('noticeNo').value = noticeNo;
		        fetch(`${root}/api/notice/` + noticeNo)
		          .then(response => response.json())
		          .then(data => setNotice(data));
		      };
		      function setNotice(data) {
		          let subject = document.getElementById('subject');
		          let content = document.getElementById('content');

		          subject.value = data.subject;
		          content.innerText = data.content;
		        }

		      
		      document.querySelector("#btn-register").addEventListener("click",
						function() {
							if (!document.querySelector("#subject").value) {
								alert("제목 입력!!");
								return;
							} else if (!document.querySelector("#content").value) {
								alert("내용 입력!!");
								return;
							} 
							noticeModify();

						});
				
		
		function noticeModify() {
			let noticeNo = document.getElementById('noticeNo').value;
	        let subject = document.querySelector(`#subject`).value;
	        let content = document.querySelector(`#content`).value;
	        let modifyNotice = {
	          subject :subject,
			  content:content
	        };
	        let config = {
	          method: "PUT",
	          headers: {
	            "Content-Type": "application/json"
	          },
	          body: JSON.stringify(modifyNotice),
	        };
	        fetch(`${root}/api/notice/`+noticeNo, config)
	          .then(response => response.json())
	          .then(data => {
				alert("수정되었습니다.");
				location.href='/assets/notice.html';
			  });
	      }
	</script>
</body>
</html>